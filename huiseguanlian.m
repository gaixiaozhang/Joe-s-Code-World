clear;clc; 
yb=[48 1495 169 30 2613 454 39 107 73 129 35 251 2887 104 ...
    166 130 8337 357 39 18419 104 126 7373 1078 93 186 60 30 ...
    266 86 486 234 1601 605 720 2457 58 505 99 248 24 128 ...
    724 5664 9285 114 112 141 55 227 225 43 1271 1817 90 102 ...
    225 4735 943 841 58 298 106 3956 170 232 177 132 302 125 ...    
    410 549 38 215 48 291 98 369 32 2663 29 846 208 222 ...
    228 1494 310 16084 406 97 54 2188 16872 235 211 831 214 83 ...
    135 905 261 1935 99 190 58 48 150 79 130 2704 130 10028 ...
    263 331 1459 53 286 2405 5738 13625 1138 5442 2310 1486 1886 26223 ...
    4508 46 357 1665 37 3350 1366 1674 71 288 306 262 118 1326 ...
    15 468 220 38 87 32 125]; 
fz=[5.8 5.5 7 6.1 5.9 7.2 3.6 6.3 4.8 4.8 2.9 3.4 8.6 5.9 ...
    4.7 3.9 7.2 7.6 5.6 9.2 5.6 6.7 7.4 7.1 5.2 3.6 5.7 4.6 ...
    8 6.1 7.2 8.1 7.6 7 5.4 6.3 6.2 6.1 6.4 6.2 7.3 3.2 ...
    7 8.3 6.9 6.6 5.9 6.4 3.3 4.8 6.4 4.1 8.5 7.2 5.3 7.7 ...
    7 7.2 5.2 4.3 4.3 6.3 3 8.1 5.4 5.5 4.2 3.9 6.3 6.3 ...
    4 7.1 6.4 4.9 4.1 6.1 5.2 5.8 5.3 7.4 7.3 7.7 5.0 6.3 ...
    4.4 6.6 7.2 8.8 7.2 5.9 4.4 6.8 7.2 3.6 5.9 6.4 6.1 5.7 ...
    5.9 6.4 6.1 5.0 2.5 7.2 4.8 4.3 4.6 5.5 3.9 8.7 3.6 7.5 ...
    7.2 3.5 3.8 5.8 6.2 5.6 3.8 5.4 8.2 7.9 4.9 5.1 4.8 6.3 ...
    7.3 6.3 7.6 6.4 4.1 4.6 6.2 6.7 2.5 3.3 4 7.4 3.2 8.4 ...
    6.9 3.3 6 4.8 6.7 6.3 6.9];
[rows,cols]=size(fz); 
p=0.3;
[m,n]=size(yb);       
R=[];  
for irow=1:rows      
    yy=fz(irow,:);      
    data=[yy;yb];      
    data_gyh1=yb    
    for i=1:m+1          
        for j=1:n               
            data_gyh(i,j)=data(i,j)/data_gyh1(j);          
        end
    end
    for i=2:m+1          
        for j=1:n               
            Dij(i-1,j)=abs(data_gyh(1,j)-data_gyh(i,j));          
        end
    end
    Dijmax=max(max(Dij));      
    Dijmin=min(min(Dij));            
    for i=1:m          
        for j=1:n               
            Lij(i,j)=(Dijmin+p*Dijmax)/(Dij(i,j)+p*Dijmax);          
        end
    end
    LijRowSum=sum(Lij');            
    for i=1:m           
        Rij(i)=LijRowSum(i)/n;      
    end
    R=[R;Rij]; 
end
R